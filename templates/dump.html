<!-- templates/dump.html -->

{% extends "base.html" %}

{% block title %}Raw activities | Cycling Stats{% endblock %}

{% block content %}
<div class="container-fluid mt-3 mb-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">Activity Dump</h4>
        
        <div class="d-flex align-items-center">
            <form method="GET" action="{{ url_for('main.dump') }}" class="d-flex align-items-center me-3">
                <span class="me-2 text-muted">Last</span>
                <input type="number" id="days" name="days" 
                       class="form-control form-control-sm text-center" 
                       style="width: 60px;" value="{{ days }}">
                <span class="ms-2 me-3 text-muted">days</span>
                <button type="submit" class="btn btn-sm btn-secondary">Refresh</button>
            </form>
            
            <button class="btn btn-sm btn-outline-success" onclick="copyToClipboard(this)">Copy</button>
        </div>
    </div>

    <div>
        <textarea id="markdownTable" 
                  class="form-control bg-dark text-success font-monospace p-3" 
                  rows="22" readonly 
                  style="font-size: 0.8rem; border: 1px solid #333; resize: none; border-radius: 4px;">{{ markdown_data }}</textarea>
    </div>
    
    <div class="py-4"></div> 
</div>

<script>
    function copyToClipboard(btn) {
        const copyText = document.getElementById("markdownTable");
        
        navigator.clipboard.writeText(copyText.value).then(() => {
            // Change text and style
            const originalText = btn.innerText;
            btn.innerText = "Copied";
            btn.classList.replace('btn-outline-success', 'btn-success');
            
            // Reset after 1.5 seconds
            setTimeout(() => { 
                btn.innerText = originalText; 
                btn.classList.replace('btn-success', 'btn-outline-success');
            }, 1500);
        });
    }
</script>

{% endblock %}